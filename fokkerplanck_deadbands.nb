(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46020,        999]
NotebookOptionsPosition[     41795,        934]
NotebookOutlinePosition[     42161,        950]
CellTagsIndexPosition[     42118,        947]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Model ", "Section",
 CellChangeTimes->{{3.738074846939282*^9, 
  3.7380748513343596`*^9}},ExpressionUUID->"158eb54d-9bae-4d8b-8e76-\
85beaccb1d1d"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.719824663819488*^9, 3.719824666366105*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9a94a9a2-1698-403c-b134-eeb1689ecf8f"],

Cell[CellGroupData[{

Cell["Model definition", "Subsection",
 CellChangeTimes->{{3.7191325180295353`*^9, 3.719132545762587*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Defining", " ", "values", " ", "of", " ", "paramaters", " ", "in", " ", 
     "the", " ", 
     RowBox[{"model", ".", " ", "Parameters"}], " ", "aa"}], ",", " ", "bb", 
    ",", " ", 
    RowBox[{
     RowBox[{
     "\[Lambda]", " ", "and", " ", "dld", " ", "are", " ", "introduced", " ", 
      "in", " ", "order", " ", "to", " ", "nondimensionalize", " ", "the", 
      " ", "model"}], " ", "-", " ", 
     RowBox[{"aa", " ", "nondimensionalizes", " ", "frequency"}]}], ",", " ", 
    
    RowBox[{
     RowBox[{
     "bb", " ", "nondimensionalizes", " ", "power", " ", "and", " ", 
      "\[Lambda]", " ", "is", " ", "the", " ", "parameter", " ", "left", " ", 
      "in", " ", "the", " ", "nondimensionalized", " ", "Fokker"}], "-", 
     RowBox[{"Planck", " ", 
      RowBox[{"equation", ".", " ", "The"}], " ", "advantage", " ", "of", " ",
       "the", " ", "new", " ", "dimensionless", " ", "units", " ", "is", " ", 
      "that", " ", "the", " ", "characteristic", " ", "deviations", " ", "of",
       " ", "frequency", " ", "and", " ", "power", " ", "are", " ", "of", " ",
       "the", " ", "order", " ", "of", " ", 
      RowBox[{"unity", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"abparams", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"aa", "\[Rule]", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"\[Gamma]", "/", "d"}], "]"}]}], ",", 
       RowBox[{"bb", "\[Rule]", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"\[Gamma]", " ", 
          RowBox[{
           RowBox[{"\[Alpha]", "^", "2"}], "/", "d"}]}], "]"}]}], ",", 
       RowBox[{"\[Lambda]", "\[Rule]", 
        RowBox[{"\[Alpha]", "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "H", " ", "\[Gamma]"}], ")"}]}]}], ",", 
       RowBox[{"dld", "\[Rule]", 
        RowBox[{"dl", "/", "\[Alpha]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7193294436531935`*^9, 3.7193294597991314`*^9}, {
   3.719329543121868*^9, 3.719329547141972*^9}, {3.7193299664049435`*^9, 
   3.719329972899678*^9}, 3.719501440097949*^9, {3.7198246888949327`*^9, 
   3.7198247084293118`*^9}, {3.721230369469858*^9, 3.721230375161208*^9}, {
   3.721230451980147*^9, 3.7212305001852336`*^9}, {3.740308251626196*^9, 
   3.740308265126239*^9}, {3.7403083009237776`*^9, 3.7403083878606944`*^9}, {
   3.7403093162013474`*^9, 3.74030931889283*^9}, {3.7403096897465525`*^9, 
   3.74030969015782*^9}, {3.740309745673288*^9, 3.7403098277720294`*^9}, {
   3.740400673737314*^9, 3.740400735321707*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"c49b355b-051c-4e4b-93b7-53a4060e4965"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"H", " ", "-", " ", 
    RowBox[{"inertia", " ", "constant", " ", 
     RowBox[{"(", "s", ")"}]}]}], ";", " ", 
   RowBox[{"d", " ", "-", " ", 
    RowBox[{"noise", " ", "diffusion", " ", "coefficient"}]}], ";", " ", 
   RowBox[{"\[Gamma]", " ", "-", " ", 
    RowBox[{
    "inverse", " ", "mean", " ", "load", " ", "reversal", " ", "time", " ", 
     RowBox[{"(", 
      RowBox[{"1", "/", "s"}], ")"}]}]}], ";", " ", 
   RowBox[{"\[Alpha]", " ", "-", " ", 
    RowBox[{"generators", " ", "inverse", " ", "droop", " ", 
     RowBox[{"(", 
      RowBox[{"p", ".", "u", "."}], ")"}]}]}], ";", 
   RowBox[{"xdb", " ", "-", " ", 
    RowBox[{"deadband", " ", "width", " ", "in", " ", 
     RowBox[{"p", ".", "u", ".", " ", 
      RowBox[{"(", 
       RowBox[{
       "in", " ", "respect", " ", "to", " ", "nominal", " ", "frequency"}], 
       ")"}]}]}]}], ";", " ", 
   RowBox[{"dl", " ", "-", " ", "load", "-", 
    RowBox[{"frequency", " ", "sensittivity", " ", "coeeficient", " ", 
     RowBox[{"(", 
      RowBox[{"p", ".", "u", "."}], ")"}]}]}], ";", " ", 
   RowBox[{"\[Beta]", " ", "-", " ", 
    RowBox[{"dimensionless", " ", "width", " ", "of", " ", "deadband"}]}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7403084043461065`*^9, 3.7403084332998176`*^9}, {
  3.7403093397973356`*^9, 3.7403093975763025`*^9}, {3.7403094415798645`*^9, 
  3.740309494321858*^9}, {3.740309697986319*^9, 3.740309729298525*^9}, {
  3.740309768462661*^9, 3.7403097839084024`*^9}, {3.7403098322617455`*^9, 
  3.7403098386703176`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"88b1aa30-fcf1-46ab-b36d-ddf71d5ace5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumVals", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"H", "\[Rule]", "6."}], ",", 
     RowBox[{"d", "\[Rule]", 
      RowBox[{"6.", " ", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "6"}], ")"}]}]}]}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "0.033"}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", "12.5"}], ",", 
     RowBox[{"xdb", "\[Rule]", " ", 
      RowBox[{"15", " ", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}], "/", "50."}]}]}], ",", 
     RowBox[{"dl", "\[Rule]", "1.5"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7193299957853703`*^9, 3.7193300372381725`*^9}, {
   3.7193301457672744`*^9, 3.7193301460935583`*^9}, 3.719337456740638*^9, {
   3.7193377154437017`*^9, 3.7193377155216827`*^9}, {3.7193382984303646`*^9, 
   3.7193383153229656`*^9}, {3.7193383868669567`*^9, 3.719338386944384*^9}, 
   3.7193384888741665`*^9, {3.7193385458343964`*^9, 3.7193385471080923`*^9}, {
   3.719338593107785*^9, 3.719338593260788*^9}, {3.7193386654001303`*^9, 
   3.719338665537563*^9}, {3.7193394877109995`*^9, 3.7193394878829527`*^9}, {
   3.719339588009371*^9, 3.719339588181222*^9}, {3.719339840474243*^9, 
   3.7193398416090117`*^9}, {3.7193399059571056`*^9, 3.719339906066467*^9}, {
   3.7193399677450094`*^9, 3.7193399678971167`*^9}, {3.7193400250791416`*^9, 
   3.7193400254011607`*^9}, {3.719497979650962*^9, 3.7194979797914867`*^9}, {
   3.7194990562504005`*^9, 3.7194990575005503`*^9}, 3.719501443021882*^9, {
   3.7195085918089275`*^9, 3.7195085919140077`*^9}, {3.7195088495371113`*^9, 
   3.719508849702757*^9}, {3.719510141488867*^9, 3.7195101416138496`*^9}, {
   3.719563021884416*^9, 3.719563022107991*^9}, {3.719563408669541*^9, 
   3.719563409469697*^9}, 3.719564628185876*^9, {3.719564890235032*^9, 
   3.719564897470041*^9}, {3.7195660710085974`*^9, 3.719566073199463*^9}, {
   3.7195663177472444`*^9, 3.719566324448037*^9}, {3.7195668217171946`*^9, 
   3.7195668254871874`*^9}, {3.7195669046418386`*^9, 3.719566904719006*^9}, {
   3.7195672162740164`*^9, 3.7195672240667176`*^9}, {3.719567930900446*^9, 
   3.7195679368653593`*^9}, 3.7195684692017117`*^9, {3.7195685361197405`*^9, 
   3.719568536866774*^9}, {3.7195688343251953`*^9, 3.7195688371055937`*^9}, {
   3.719569067188828*^9, 3.719569067315179*^9}, {3.7195693527546177`*^9, 
   3.719569352849872*^9}, {3.71956970381231*^9, 3.7195697038905163`*^9}, {
   3.7195699626941648`*^9, 3.7195699627874107`*^9}, {3.7195701271468534`*^9, 
   3.7195701302576375`*^9}, {3.7195703104660816`*^9, 3.719570314805326*^9}, {
   3.7195712366334224`*^9, 3.7195712368052235`*^9}, {3.7197455717928414`*^9, 
   3.7197455728153543`*^9}, {3.719756423357944*^9, 3.7197564274693127`*^9}, {
   3.719756588942379*^9, 3.719756593710126*^9}, {3.71976073133003*^9, 
   3.719760734014058*^9}, {3.7198240613392973`*^9, 3.7198240768110266`*^9}, {
   3.7198246565087385`*^9, 3.7198246567952623`*^9}, {3.7198247126217847`*^9, 
   3.7198247232601852`*^9}, 3.719825257470338*^9, {3.719825367183037*^9, 
   3.719825378556842*^9}, {3.7198427465186915`*^9, 3.7198427617030945`*^9}, {
   3.719844456247631*^9, 3.719844456342852*^9}, {3.7198463919816823`*^9, 
   3.7198463920438395`*^9}, {3.7198563208033104`*^9, 3.719856321390189*^9}, 
   3.719856405903318*^9, {3.7198567477920313`*^9, 3.7198567481409507`*^9}, {
   3.7198568731366744`*^9, 3.7198568732128596`*^9}, {3.7198569805414066`*^9, 
   3.719856980652669*^9}, 3.719857145744897*^9, {3.7199288855239525`*^9, 
   3.719928885620209*^9}, {3.7199291696037464`*^9, 3.7199291696839523`*^9}, {
   3.7203728108265133`*^9, 3.7203728187596197`*^9}, {3.720374505516121*^9, 
   3.720374507223626*^9}, {3.7203745404109607`*^9, 3.7203745414316344`*^9}, {
   3.720718096381651*^9, 3.720718113352206*^9}, {3.721141302724253*^9, 
   3.7211413039573793`*^9}, {3.7211413469978023`*^9, 3.72114136018312*^9}, {
   3.7211415143099484`*^9, 3.7211415157336707`*^9}, 3.7211415539432507`*^9, {
   3.7211416140063086`*^9, 3.7211416617649765`*^9}, {3.7212335831328983`*^9, 
   3.721233583196317*^9}, {3.7212338927332077`*^9, 3.7212338928615503`*^9}, {
   3.7212341550854445`*^9, 3.7212341553249893`*^9}, {3.7311555616726913`*^9, 
   3.7311555651388645`*^9}, {3.737745427596888*^9, 3.737745454818303*^9}, {
   3.7379800557449923`*^9, 3.737980055902212*^9}, {3.7380748746904745`*^9, 
   3.7380748775984573`*^9}, {3.7380750089259067`*^9, 
   3.7380750090508995`*^9}, {3.738075252567127*^9, 3.7380752526891413`*^9}, {
   3.7380754348300333`*^9, 3.7380754556895924`*^9}, {3.738075684924607*^9, 
   3.7380756850338125`*^9}, {3.7380758535982566`*^9, 3.738075853689639*^9}, {
   3.7380760342681694`*^9, 3.738076035830598*^9}, {3.73807628800742*^9, 
   3.7380762881012945`*^9}, {3.7380787519760313`*^9, 
   3.7380787520727873`*^9}, {3.7381026357117567`*^9, 
   3.7381026361709776`*^9}, {3.7381409126742735`*^9, 
   3.7381409281662483`*^9}, {3.738141650274616*^9, 3.7381416504487514`*^9}, {
   3.7381419211976104`*^9, 3.738141921361458*^9}, {3.7381669270331697`*^9, 
   3.7381669271605215`*^9}, {3.7381670785362864`*^9, 3.738167078645735*^9}, {
   3.7381671456766224`*^9, 3.7381671457235045`*^9}, {3.738353307165003*^9, 
   3.7383533086915264`*^9}, {3.7383536371251574`*^9, 
   3.7383536372032027`*^9}, {3.7383537025637045`*^9, 3.738353702657466*^9}, {
   3.7383537592765875`*^9, 3.7383537593561373`*^9}, {3.7383547413539577`*^9, 
   3.7383547414646463`*^9}, {3.7383994081407475`*^9, 3.738399413265011*^9}, {
   3.738399492635212*^9, 3.738399501079217*^9}, {3.7383995500936966`*^9, 
   3.7383995522129107`*^9}, {3.738400249990153*^9, 3.738400250917674*^9}, {
   3.738400465192356*^9, 3.7384004690620155`*^9}, {3.738400562309595*^9, 
   3.7384005742294345`*^9}, {3.738401429766695*^9, 3.738401431125661*^9}, {
   3.7384020669668274`*^9, 3.738402070743738*^9}, {3.7384022866345468`*^9, 
   3.7384022953981485`*^9}, {3.7384189606616898`*^9, 3.738418962565568*^9}, {
   3.7384191716705275`*^9, 3.738419172471422*^9}, {3.7386107500261354`*^9, 
   3.7386107507731757`*^9}, {3.738610813978161*^9, 3.738610814100833*^9}, {
   3.7386111551243563`*^9, 3.738611159280771*^9}, {3.7391882168172026`*^9, 
   3.73918821773833*^9}, {3.739188482733438*^9, 3.7391884950766764`*^9}, {
   3.74030933327773*^9, 3.7403093336591654`*^9}, {3.740309417393875*^9, 
   3.74030941776864*^9}, {3.7404073271352873`*^9, 
   3.740407327245988*^9}},ExpressionUUID->"d43aae16-314c-4a90-ab5d-\
27c6a7fdde89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"betap", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Beta]", "\[Rule]", 
      RowBox[{"xdb", " ", "bb"}]}], "}"}], "//.", "abparams"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719329517298916*^9, 3.7193295770065937`*^9}, {
   3.719330087391082*^9, 3.7193300911889706`*^9}, 3.719501428522423*^9, {
   3.7195703180276537`*^9, 3.719570319285712*^9}, {3.71975644446224*^9, 
   3.7197564458700275`*^9}, {3.721230561592823*^9, 3.7212305744905767`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"6cad8b49-f1b9-40b2-a1f4-83bb260de7da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mainparams", "=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{"abparams", ",", "betap"}], "]"}], "//.", "NumVals"}]}]], "Input",\

 CellChangeTimes->{{3.7193300512038264`*^9, 3.7193300698650928`*^9}, {
  3.71982463692605*^9, 3.719824638671847*^9}, {3.7198247283027687`*^9, 
  3.7198247285551243`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"b5e79496-6358-45c6-ba2f-adbbd99512be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"aa", "\[Rule]", "74.16198487095663`"}], ",", 
   RowBox[{"bb", "\[Rule]", "778.7008411450446`"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "26.515151515151516`"}], ",", 
   RowBox[{"dld", "\[Rule]", "0.14285714285714285`"}], ",", 
   RowBox[{"\[Beta]", "\[Rule]", "0.2336102523435134`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7198241610697737`*^9, 3.7198246396961017`*^9, 3.7198246708689103`*^9, 
   3.7198247330653677`*^9, 3.7198248049772205`*^9, 3.719825101429384*^9, 
   3.719825263999325*^9, {3.719825373306543*^9, 3.7198253837311096`*^9}, 
   3.7198427673390827`*^9, 3.719843371092353*^9, 3.7198439318414307`*^9, 
   3.71984446220545*^9, 3.7198463968937135`*^9, 3.7198563276823215`*^9, 
   3.719856410284872*^9, 3.719856751853803*^9, 3.719856876619891*^9, 
   3.7198569843475266`*^9, 3.7198571495229435`*^9, 3.719928890262559*^9, 
   3.7199291747615814`*^9, 3.720178388310753*^9, 3.720372827850806*^9, 
   3.7203728747686296`*^9, 3.7203745464871855`*^9, 3.72071812244167*^9, 
   3.7211413648728695`*^9, {3.721141532869667*^9, 3.7211415587113075`*^9}, {
   3.721141619772665*^9, 3.7211416359884243`*^9}, 3.721141667677782*^9, 
   3.721230579546068*^9, 3.7212335902090683`*^9, 3.7212339002101555`*^9, 
   3.7212341613854423`*^9, {3.7311555483254185`*^9, 3.7311555698724785`*^9}, 
   3.7377455877454233`*^9, 3.737745703202536*^9, 3.737745765518839*^9, 
   3.7377458699987617`*^9, 3.7377459558005533`*^9, 3.737897148009519*^9, 
   3.737899503750439*^9, 3.7379800788292785`*^9, 3.7380748841979275`*^9, 
   3.7380750151587944`*^9, 3.7380752610022597`*^9, 3.738075463829734*^9, 
   3.7380756901454954`*^9, 3.7380758583119564`*^9, 3.738076040288519*^9, 
   3.738076293292039*^9, 3.7380787568579493`*^9, 3.7380795613344097`*^9, 
   3.738102641835223*^9, 3.738140974360966*^9, 3.738141318195265*^9, 
   3.7381416609351683`*^9, 3.7381419298344517`*^9, 3.7381669816109705`*^9, 
   3.738167082277548*^9, 3.738167148834673*^9, 3.7383533174337997`*^9, 
   3.7383535066793566`*^9, 3.73835357198534*^9, 3.7383536506533365`*^9, 
   3.7383537060899506`*^9, 3.7383537647265015`*^9, 3.7383993339774466`*^9, 
   3.738399423309713*^9, 3.73839956528528*^9, {3.7384002464226913`*^9, 
   3.738400270016612*^9}, {3.738400353191245*^9, 3.738400378790805*^9}, 
   3.738400474489481*^9, 3.7384005785250435`*^9, 3.7384011620565023`*^9, 
   3.738401437646022*^9, 3.738401833130314*^9, 3.738402076778626*^9, 
   3.738402299689644*^9, 3.738418990997555*^9, 3.7384191766522074`*^9, 
   3.738610757333598*^9, 3.738610965838348*^9, 3.7386111634280024`*^9, 
   3.7391882220450497`*^9, 3.7391884997384424`*^9, 3.739657068076679*^9, 
   3.740405905062467*^9, 3.740406617607475*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"da936b89-5d95-4c5f-9473-cbd2502dfe70"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Defining", " ", "the", " ", "structure", " ", "of", " ", "the", " ", 
    "Fokker"}], "-", 
   RowBox[{"Planck", " ", "equation"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.740309844706628*^9, 3.7403098707905073`*^9}, {
  3.7404006448584785`*^9, 3.7404006538314867`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"124d114e-90a6-4039-928b-2c2342f0250f"],

Cell[BoxData[{
 RowBox[{"diffMatrix", ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "//.", 
   "mainparams"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseFlow", "[", 
    RowBox[{"\[Omega]_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"0.0", ",", 
     RowBox[{"-", "p"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"droopFlow", "[", 
   RowBox[{"\[Omega]_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]", " ", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Omega]"}], "-", "\[Beta]", " ", "+", 
            RowBox[{"\[Beta]", " ", "dld"}]}], ",", 
           RowBox[{"\[Omega]", "<", 
            RowBox[{"-", "\[Beta]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Omega]"}], "+", "\[Beta]", "-", 
            RowBox[{"\[Beta]", " ", "dld"}]}], ",", 
           RowBox[{"\[Omega]", ">", "\[Beta]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Omega]"}], " ", "dld"}], ",", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], " ", "\[LessEqual]", "\[Omega]", 
            "\[LessEqual]", "\[Beta]"}]}], "}"}]}], "}"}], " ", "]"}]}], ",", 
     "0.0"}], "}"}], "//.", "mainparams"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"couplingFlow", "[", 
   RowBox[{"\[Omega]_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], " ", "p"}], ",", "0.0"}], "}"}], "//.", 
   "mainparams"}]}]}], "Input",
 CellChangeTimes->{{3.719132256325469*^9, 3.719132283845944*^9}, {
   3.719132438862973*^9, 3.71913247672573*^9}, {3.719132515485696*^9, 
   3.719132526132517*^9}, {3.7191329641746187`*^9, 3.7191329642781477`*^9}, {
   3.719133096744306*^9, 3.719133097104089*^9}, {3.719133203878263*^9, 
   3.719133204062496*^9}, {3.719136298098219*^9, 3.719136402732333*^9}, {
   3.719136942687923*^9, 3.7191369456781816`*^9}, {3.719224989237276*^9, 
   3.7192250398510404`*^9}, {3.7192251949569654`*^9, 3.719225280971713*^9}, {
   3.719225453193095*^9, 3.7192254534274693`*^9}, {3.719225672011765*^9, 
   3.7192256805811567`*^9}, {3.719328860157854*^9, 3.719329010269603*^9}, {
   3.7193292245982637`*^9, 3.7193293638780985`*^9}, {3.7193302238746586`*^9, 
   3.71933024435876*^9}, {3.7193302847941265`*^9, 3.7193303219699774`*^9}, {
   3.719330407720108*^9, 3.719330408058826*^9}, {3.7193369727596793`*^9, 
   3.7193370268914404`*^9}, {3.719337127085359*^9, 3.7193371274321156`*^9}, 
   3.7194976354774127`*^9, {3.7195020840822287`*^9, 3.7195020867836885`*^9}, 
   3.7195646078362255`*^9, {3.719564651048358*^9, 3.719564652562338*^9}, {
   3.7195646831361866`*^9, 3.7195646838550177`*^9}, {3.719823980384712*^9, 
   3.719823985599778*^9}, {3.7198240339664373`*^9, 3.719824040254724*^9}, {
   3.7198244751005087`*^9, 3.7198244783819237`*^9}, {3.7198247365733986`*^9, 
   3.7198247445112066`*^9}, {3.719825068254442*^9, 3.7198250878082733`*^9}, {
   3.7212306225881796`*^9, 3.721230624489029*^9}, {3.7212306768098*^9, 
   3.7212306801037426`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"c93d0aea-c047-4dd0-b7f4-8775e9f0adce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model Initialization", "Subsection",
 CellChangeTimes->{{3.71913206424892*^9, 3.719132100283633*^9}, {
  3.719132579906108*^9, 
  3.719132584956781*^9}},ExpressionUUID->"5d3e3116-1d8a-4f83-8ab3-\
aa1cb787fce4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Inititalization", " ", "of", " ", "numerical", " ", "procedure"}],
    ",", " ", 
   RowBox[{
    RowBox[{"a", " ", "box", " ", "of", " ", "the", " ", "size"}], " ", 
    "\[PlusMinus]", 
    RowBox[{
    "10", " ", "in", " ", "dimensionless", " ", "units", " ", "is", " ", 
     RowBox[{"chosen", ".", " ", "A"}], " ", "mesh", " ", "is", " ", 
     "refined", " ", "to", " ", "get", " ", "better", " ", "resolution", " ", 
     "around", " ", "the", " ", "center", " ", "of", " ", "the", " ", "box", 
     " ", "where", " ", "the", " ", "PDF", " ", "has", " ", "maximum", " ", 
     "values"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7404006582606583`*^9, 3.74040066683972*^9}, {
  3.7404007553850794`*^9, 3.7404008838656635`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"fd268c4e-0dc5-48d6-9804-9b5b25caf351"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nr", "=", 
   RowBox[{"ToNumericalRegion", "[", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10"}], ",", 
        RowBox[{"-", "10"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "10"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vd", "=", 
   RowBox[{"NDSolve`VariableData", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<DependentVariables\>\"", ",", "\"\<Space\>\""}], "}"}], 
     "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "F", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "p"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sd", "=", 
   RowBox[{"NDSolve`SolutionData", "[", 
    RowBox[{
     RowBox[{"{", "\"\<Space\>\"", "}"}], "\[Rule]", 
     RowBox[{"{", "nr", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"flowCoefficients", "[", "flow_", "]"}], ":=", 
   RowBox[{"InitializePDECoefficients", "[", 
    RowBox[{"vd", ",", "sd", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<ConservativeConvectionCoefficients\>\"", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"flow", "[", 
         RowBox[{"\[Omega]", ",", "p"}], "]"}], "}"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"baseCoeff", "=", 
   RowBox[{"InitializePDECoefficients", "[", 
    RowBox[{"vd", ",", "sd", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DiffusionCoefficients\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"-", "diffMatrix"}], "}"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ConservativeConvectionCoefficients\>\"", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"baseFlow", "[", 
         RowBox[{"\[Omega]", ",", "p"}], "]"}], "}"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"droopCoeff", "=", 
   RowBox[{"flowCoefficients", "[", "droopFlow", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"couplingCoeff", "=", 
   RowBox[{"flowCoefficients", "[", "couplingFlow", "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.7191321538025723`*^9, 3.7191321626479073`*^9}, {
   3.7191322380921926`*^9, 3.719132240428032*^9}, {3.719132591181479*^9, 
   3.7191326507264233`*^9}, 3.7191328892210617`*^9, 3.7191362477017307`*^9, {
   3.7191364413028097`*^9, 3.7191365178899927`*^9}, {3.7191369484787703`*^9, 
   3.7191370966828547`*^9}, {3.71913713833494*^9, 3.719137149061572*^9}, {
   3.7192258292239666`*^9, 3.7192258404245734`*^9}, {3.7193371622730227`*^9, 
   3.7193371659519787`*^9}, {3.719337284007002*^9, 3.719337286655489*^9}, {
   3.7193375888081627`*^9, 3.7193375913884726`*^9}, {3.719337789563041*^9, 
   3.7193377948569074`*^9}, {3.7194971631032877`*^9, 
   3.7194971848347387`*^9}, {3.7195023609499884`*^9, 3.719502362963342*^9}, {
   3.719566835506847*^9, 3.719566839536605*^9}, {3.719844528648219*^9, 
   3.719844533386829*^9}, {3.719846712930699*^9, 3.719846715406275*^9}, {
   3.7198467924342155`*^9, 3.7198468061887875`*^9}, {3.7198563421011777`*^9, 
   3.7198563585084047`*^9}, {3.7201784173761187`*^9, 
   3.7201784217878647`*^9}, {3.7203729198164783`*^9, 3.720372921928103*^9}, {
   3.721233556324113*^9, 3.7212335582720757`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"b69660f0-1fa7-4a76-b9bb-1fcdace737d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gaussRefine", "[", 
   RowBox[{"min_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vertices", ",", " ", "area"}], "}"}], "\[Function]", 
   RowBox[{"area", ">", 
    RowBox[{"min", " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"Mean", "@", "vertices"}], "]"}], "/", "r"}], ")"}], "^", 
       "2"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdfRefine", "[", 
   RowBox[{"pdf_", ",", "min_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vertices", ",", "area"}], "}"}], "\[Function]", 
   RowBox[{
    RowBox[{"area", " ", 
     RowBox[{"Abs", "[", 
      RowBox[{"(", 
       RowBox[{"pdf", "@@", 
        RowBox[{"Mean", "[", "vertices", "]"}]}], ")"}], "]"}]}], ">", 
    "min"}]}]}]}], "Input",
 CellChangeTimes->{{3.719135337867812*^9, 3.719135402918359*^9}, {
  3.719135436488805*^9, 3.719135503346032*^9}, {3.719137721115541*^9, 
  3.719137747017333*^9}, {3.719137779774027*^9, 3.7191377805105352`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"d3e64155-a591-42e8-81ea-dc95794a5eca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"skewGaussRefine", "[", 
   RowBox[{"skewGauss_", ",", "min_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vertices", ",", "area"}], "}"}], "\[Function]", 
   RowBox[{
    RowBox[{"area", " ", 
     RowBox[{"Abs", "[", 
      RowBox[{"(", 
       RowBox[{"skewGauss", "@@", 
        RowBox[{"Mean", "[", "vertices", "]"}]}], ")"}], "]"}]}], ">", 
    "min"}]}]}]], "Input",
 CellChangeTimes->{{3.7198438959910593`*^9, 3.7198439163903227`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"4532e986-bd38-4a41-ba05-786776d15ed4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getMeshData", "[", "refine_", "]"}], ":=", 
   RowBox[{"InitializePDEMethodData", "[", "\[IndentingNewLine]", 
    RowBox[{
    "vd", ",", "\[IndentingNewLine]", "sd", ",", "\[IndentingNewLine]", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<FiniteElement\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<MeshOptions\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MeshRefinementFunction", "\[Rule]", "refine"}], ",", 
           RowBox[{"\"\<MeshOrder\>\"", "\[Rule]", "2"}]}], "}"}]}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719136539851206*^9, 3.719136606513345*^9}, {
  3.720372840728095*^9, 3.720372842023512*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"d6de3002-6c63-4235-9fb6-ad1ad1516c6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getStiffnessMatrix", "[", 
    RowBox[{"coeff_", ",", "meshData_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"DiscretizePDE", "[", 
      RowBox[{"coeff", ",", "meshData", ",", "sd", ",", 
       RowBox[{"\"\<AssembleSystemMatrices\>\"", "\[Rule]", "True"}]}], "]"}],
      "[", "\"\<All\>\"", "]"}], "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allStiffnessMatrices", "[", "meshData_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"getStiffnessMatrix", "[", 
     RowBox[{"#", ",", "meshData"}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"baseCoeff", ",", "droopCoeff", ",", "couplingCoeff"}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.719136619965333*^9, 3.719136671876102*^9}, {
  3.719136703222618*^9, 3.719136703389908*^9}, {3.719136838635151*^9, 
  3.7191368823137703`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"2435b603-cac2-4c58-8e74-1ef62d963caf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gaussMesh", "=", 
   RowBox[{"getMeshData", "[", 
    RowBox[{"gaussRefine", "[", 
     RowBox[{"0.005", ",", "5.0"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaussMesh", "[", "\"\<ElementMesh\>\"", "]"}], "[", 
   "\"\<Wireframe\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.719137363870257*^9, 3.719137376588276*^9}, {
  3.7195051357846518`*^9, 3.7195051655257864`*^9}, {3.719508927964163*^9, 
  3.719508930008383*^9}, {3.719566853922861*^9, 3.7195668594966784`*^9}, {
  3.7201783992759733`*^9, 3.7201783993671956`*^9}, {3.7203729301038475`*^9, 
  3.720372930182086*^9}, {3.7212336149728594`*^9, 3.721233615580725*^9}, {
  3.721234177121005*^9, 3.72123417772614*^9}, {3.731155870312424*^9, 
  3.7311558708548717`*^9}, {3.7377458578149033`*^9, 3.7377458597317934`*^9}, {
  3.7377458911972227`*^9, 3.7377458957795353`*^9}, {3.7380795480646276`*^9, 
  3.7380795531939287`*^9}, {3.738141286055771*^9, 3.738141286361433*^9}, {
  3.7383534761163054`*^9, 3.738353477757184*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"08bd949e-09c7-4274-9021-ded33c969bad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution", "Section",
 CellChangeTimes->{{3.737900529910819*^9, 
  3.737900535245099*^9}},ExpressionUUID->"1a07ad59-cfec-4557-882c-\
09253ed4e382"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Numerical", " ", "evaluation", " ", "of", " ", "stiffness", " ", "matrix", 
   " ", "for", " ", "the", " ", "system"}], "*)"}]], "Input",
 CellChangeTimes->{{3.740405430921797*^9, 3.7404054709099035`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"6822720e-9313-4d12-86a0-b27e406c6de5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bm", ",", "dm", ",", "cm"}], "}"}], "=", 
   RowBox[{"allStiffnessMatrices", "[", "gaussMesh", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.719137320205937*^9, 3.719137346312282*^9}, 
   3.7383535496450467`*^9, 3.738353656831457*^9, 3.738401779819866*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"376929dc-fe2c-4245-8ac5-0577302e3971"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Finding", " ", "numerical", " ", "solution", " ", "of", " ", "the", " ", 
    "Fokker"}], "-", 
   RowBox[{"Planck", " ", 
    RowBox[{"equation", ".", " ", "Ploting"}], " ", "in", " ", 
    "dimensionless", " ", "coordinates"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7404054756093645`*^9, 3.740405490972308*^9}, {
  3.7404055949902573`*^9, 3.740405603836607*^9}, {3.7404057958544006`*^9, 
  3.7404058028765965`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"ff9ef4dd-5193-4e2f-b17b-410b3aeb46e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getPDF", "[", 
   RowBox[{"op_", ",", " ", "meshData_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Eigensystem", "[", 
     RowBox[{"op", ",", 
      RowBox[{"-", "1"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
   RowBox[{"(", 
    RowBox[{"sol", "\[Function]", 
     RowBox[{"ElementMeshInterpolation", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"meshData", "[", "\"\<ElementMesh\>\"", "]"}], "}"}], ",", 
       " ", "sol"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotPDF", "[", "pdf_", "]"}], ":=", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{
    RowBox[{"Abs", "@", 
     RowBox[{"pdf", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "200"}], ",", 
    RowBox[{"MaxRecursion", "\[Rule]", "1"}], ",", 
    RowBox[{"Contours", "\[Rule]", "20"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.719137389974142*^9, 3.719137493710299*^9}, {
  3.7191375504504957`*^9, 3.719137578624024*^9}, {3.7194976790104933`*^9, 
  3.719497679119921*^9}, {3.7197565306222134`*^9, 3.719756535982503*^9}, {
  3.721230789737286*^9, 3.7212307945543437`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"ad13dc27-73bf-449b-a271-f85504dab3f0"],

Cell[BoxData[
 RowBox[{"pdf", "=", 
  RowBox[{"getPDF", "[", 
   RowBox[{
    RowBox[{"bm", " ", "+", " ", "cm", "+", "dm"}], ",", "gaussMesh"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7191374960386667`*^9, 3.719137534456229*^9}, {
   3.7191375865747747`*^9, 3.719137589680621*^9}, {3.719137620440701*^9, 
   3.719137630218054*^9}, {3.7191376728052073`*^9, 3.719137685612609*^9}, {
   3.719138001163371*^9, 3.719138006766325*^9}, 3.719138042471202*^9, {
   3.7193381816121874`*^9, 3.7193381883655615`*^9}, {3.738166960708519*^9, 
   3.738166965939295*^9}, 3.7404056163371964`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"cea7d7ca-39ae-4814-90b8-7c25bc68d5fe"],

Cell[BoxData[
 RowBox[{"plotPDF", "[", "pdf", "]"}]], "Input",
 CellChangeTimes->{3.740405836700185*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"c5320ed3-482d-45e0-ad74-500eeb9afce8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Dimensionalizing", " ", "the", " ", "solution", " ", "and", " ", 
   "contourplotting", " ", "the", " ", "PDF"}], "*)"}]], "Input",
 CellChangeTimes->{{3.740405703794427*^9, 3.740405761773489*^9}, 
   3.74040582111586*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"3a756df7-96f6-4f99-b4d6-a0acb30542c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pdfnorm", "[", 
    RowBox[{"w_", ",", "p_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"pdf", "[", 
     RowBox[{
      RowBox[{"w", " ", 
       RowBox[{"bb", "/", "50000."}]}], ",", 
      RowBox[{"p", " ", "aa"}]}], "]"}], "//.", "mainparams"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.74040576895726*^9, 3.7404057731799893`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"480ca9d6-a572-446f-9916-366c1d9eb24c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotPDF2Dnorm", "[", "pdf_", "]"}], ":=", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{
    RowBox[{"Abs", "@", 
     RowBox[{"pdf", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "100."}], ",", "100."}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "0.02"}], ",", "0.02"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[CapitalDelta]\[Omega](mHz)\>\"", ",", 
       "\"\<\[CapitalDelta]P(p.u.)\>\""}], "}"}]}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
    RowBox[{"Contours", "\[Rule]", "100"}], ",", 
    RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"f629ef58-e7d1-4a17-a5f2-5a3dcdc931a7"],

Cell[BoxData[
 RowBox[{"plotPDF2Dnorm", "[", "pdfnorm", "]"}]], "Input",
 CellChangeTimes->{{3.7391921186380177`*^9, 3.7391921191009264`*^9}, {
   3.7396571126281433`*^9, 3.7396571167060184`*^9}, {3.7396572783345127`*^9, 
   3.7396572829657993`*^9}, 3.7404058670221434`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"c7b36dfc-6ced-4534-93c6-0953290456e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpolation and Integration", "Section",
 CellChangeTimes->{{3.7379005543050013`*^9, 3.737900560120899*^9}, {
  3.738074825092415*^9, 
  3.738074826784051*^9}},ExpressionUUID->"8b8601c3-bd46-4802-a815-\
03996a17a52e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Constructing", " ", "a", " ", "smoth", " ", "function", " ", "from", " ", 
   "numerical", " ", 
   RowBox[{"solution", ".", " ", "Integration"}], " ", "over", " ", "power", 
   " ", "to", " ", "get", " ", "frequency", " ", "PDF"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7404059402803297`*^9, 3.7404060093088245`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"95405783-0746-4898-bcfd-acdcdea65d37"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"newpdf", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"pdf", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7195076228262477`*^9, 3.7195076311646757`*^9}, {
   3.719507678448969*^9, 3.7195076953032446`*^9}, 3.7195656527029247`*^9, 
   3.719844326344022*^9, 3.7198564750529504`*^9, 3.720373298199156*^9, {
   3.7381672370424232`*^9, 3.7381672562254877`*^9}, {3.738399601468011*^9, 
   3.738399602632973*^9}, {3.738400336919779*^9, 3.7384003422943807`*^9}, {
   3.7404059745267963`*^9, 3.7404059765105257`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"0647d9ea-aff7-4a27-95e4-101e0203d761"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ompdf", "[", "x_", "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"newpdf", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "8"}], ",", "8"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719507406403039*^9, 3.719507420967677*^9}, {
   3.719507476399249*^9, 3.719507515037887*^9}, {3.7195076422199945`*^9, 
   3.7195076458690577`*^9}, {3.719507711109997*^9, 3.7195077224027147`*^9}, {
   3.7195080485613813`*^9, 3.719508057063866*^9}, {3.719508095589096*^9, 
   3.719508097678036*^9}, 3.7195656552635484`*^9, {3.719756623104515*^9, 
   3.719756626989521*^9}, {3.7198447208563814`*^9, 3.7198447228227158`*^9}, {
   3.719846878830042*^9, 3.719846880956729*^9}, {3.719856500077217*^9, 
   3.7198565016123533`*^9}, {3.7203733412446823`*^9, 3.720373343640089*^9}, {
   3.738167268146797*^9, 3.7381672866462116`*^9}, {3.74040598614275*^9, 
   3.7404060170700827`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"3acf29e1-9c49-44c8-a959-a2996382e02c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"omegaD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ompdf", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "10.0"}], ",", "10.0", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719508283075754*^9, 3.7195083639430676`*^9}, {
   3.7195649809015007`*^9, 3.7195649839665527`*^9}, {3.7195685962176933`*^9, 
   3.7195686006735334`*^9}, {3.7195740069795756`*^9, 3.719574009628255*^9}, 
   3.7197567923189716`*^9, 3.7197607654243183`*^9, 3.720373845615591*^9, {
   3.7212331656962376`*^9, 3.721233168239777*^9}, {3.7381672940847034`*^9, 
   3.738167296693878*^9}, {3.7404060267163043`*^9, 3.7404060283190575`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"86beac50-8f4d-4c45-9722-0ed4ffb80bed"],

Cell[BoxData[
 RowBox[{"omegaDs", "=", 
  RowBox[{"Interpolation", "[", "omegaD", "]"}]}]], "Input",
 CellChangeTimes->{{3.7381673298424377`*^9, 3.738167343405908*^9}, {
  3.738167765401536*^9, 3.7381677695504723`*^9}, {3.73840135016719*^9, 
  3.738401354583389*^9}, {3.7404060397415056`*^9, 3.74040604270057*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"40ad6cf0-6f6b-439a-8758-f2ab6eaaecd0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Switching", " ", "to", " ", "frequency", " ", "in", " ", 
   RowBox[{"mHz", ".", " ", "Plotting"}], " ", "the", " ", "resulting", " ", 
   "PDF"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7404064402116575`*^9, 3.740406447742511*^9}, {
  3.740406535470026*^9, 3.7404065734066267`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"ab4e5040-b640-4901-b63b-b5b21d1e7614"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"omDs", "[", "\[Omega]_", "]"}], "=", 
   RowBox[{
    RowBox[{"omegaDs", "[", " ", 
     RowBox[{
      RowBox[{"\[Omega]", " ", 
       RowBox[{"bb", "/", 
        RowBox[{"(", "500.", ")"}]}]}], " ", "+", " ", "1001"}], "]"}], "//.",
     "mainparams"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731156025362731*^9, 3.731156026114726*^9}, 
   3.7311561328696146`*^9, 3.738141165454735*^9, 3.7381682222990317`*^9, {
   3.738401371995324*^9, 3.738401373093558*^9}, 3.738402044234603*^9, {
   3.7404060590538855`*^9, 3.740406060988686*^9}, 3.740406308126685*^9, {
   3.740406470965439*^9, 3.7404064963027167`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"6f4cdd8f-736f-483b-a7e5-8dbcd4e19ac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"omDsNorm", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"omDs", "[", "\[Omega]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", 
       RowBox[{"-", "250"}], ",", "250"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7205358436975384`*^9, 3.720535854660727*^9}, {
   3.7212334688185005`*^9, 3.7212335191002264`*^9}, {3.7212337994539156`*^9, 
   3.7212338175968866`*^9}, {3.721234100977335*^9, 3.721234102188221*^9}, {
   3.721234375631922*^9, 3.7212343767804527`*^9}, {3.7379006256433935`*^9, 
   3.737900633909404*^9}, {3.7379801822950406`*^9, 3.7379801913017044`*^9}, {
   3.737980587896942*^9, 3.7379805942338524`*^9}, {3.7379807806327133`*^9, 
   3.7379807819564686`*^9}, {3.738074974318612*^9, 3.738074981783778*^9}, {
   3.7380751100808887`*^9, 3.7380751113023252`*^9}, {3.738075369189561*^9, 
   3.7380753703265257`*^9}, {3.7380756499858217`*^9, 
   3.7380756511628437`*^9}, {3.738075785256737*^9, 3.7380757862961197`*^9}, {
   3.7380759475644164`*^9, 3.73807595203432*^9}, {3.7384013853511953`*^9, 
   3.738401386517589*^9}, {3.7404060646090155`*^9, 3.740406069455059*^9}, 
   3.7404063863087196`*^9, {3.740406512338874*^9, 3.740406516081892*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"4465b0d4-a7a1-44f8-9cf0-0225fde7d973"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"omDs", "[", "\[Omega]", "]"}], "/", "omDsNorm"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"-", "200."}], ",", "200."}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7380794929699106`*^9, 3.7380794981344624`*^9}, {
  3.738079753196212*^9, 3.7380797705037518`*^9}, {3.7404063594904013`*^9, 
  3.740406376814127*^9}, {3.740406518463507*^9, 3.7404065224777517`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"6db5914e-9748-4647-b506-54af1863e829"]
}, Open  ]]
},
WindowSize->{1504, 961},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
WindowStatusArea->None,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 153, 3, 67, "Section",ExpressionUUID->"158eb54d-9bae-4d8b-8e76-85beaccb1d1d"],
Cell[736, 27, 221, 3, 28, "Input",ExpressionUUID->"9a94a9a2-1698-403c-b134-eeb1689ecf8f"],
Cell[CellGroupData[{
Cell[982, 34, 106, 1, 53, "Subsection",ExpressionUUID->"7035d847-a52f-45d8-9404-143bf275b36b"],
Cell[1091, 37, 2707, 57, 105, "Input",ExpressionUUID->"c49b355b-051c-4e4b-93b7-53a4060e4965"],
Cell[3801, 96, 1658, 36, 67, "Input",ExpressionUUID->"88b1aa30-fcf1-46ab-b36d-ddf71d5ace5a"],
Cell[5462, 134, 6463, 98, 28, "Input",ExpressionUUID->"d43aae16-314c-4a90-ab5d-27c6a7fdde89"],
Cell[11928, 234, 571, 12, 28, "Input",ExpressionUUID->"6cad8b49-f1b9-40b2-a1f4-83bb260de7da"],
Cell[CellGroupData[{
Cell[12524, 250, 408, 9, 28, "Input",ExpressionUUID->"b5e79496-6358-45c6-ba2f-adbbd99512be"],
Cell[12935, 261, 2783, 41, 32, "Output",ExpressionUUID->"da936b89-5d95-4c5f-9473-cbd2502dfe70"]
}, Open  ]],
Cell[15733, 305, 407, 9, 28, "Input",ExpressionUUID->"124d114e-90a6-4039-928b-2c2342f0250f"],
Cell[16143, 316, 3454, 78, 86, "Input",ExpressionUUID->"c93d0aea-c047-4dd0-b7f4-8775e9f0adce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19634, 399, 216, 4, 53, "Subsection",ExpressionUUID->"5d3e3116-1d8a-4f83-8ab3-aa1cb787fce4"],
Cell[19853, 405, 869, 17, 48, "Input",ExpressionUUID->"fd268c4e-0dc5-48d6-9804-9b5b25caf351"],
Cell[20725, 424, 3522, 82, 238, "Input",ExpressionUUID->"b69660f0-1fa7-4a76-b9bb-1fcdace737d1"],
Cell[24250, 508, 1167, 32, 48, "Input",ExpressionUUID->"d3e64155-a591-42e8-81ea-dc95794a5eca"],
Cell[25420, 542, 569, 15, 28, "Input",ExpressionUUID->"4532e986-bd38-4a41-ba05-786776d15ed4"],
Cell[25992, 559, 890, 18, 143, "Input",ExpressionUUID->"d6de3002-6c63-4235-9fb6-ad1ad1516c6c"],
Cell[26885, 579, 1008, 24, 48, "Input",ExpressionUUID->"2435b603-cac2-4c58-8e74-1ef62d963caf"],
Cell[27896, 605, 1138, 21, 48, "Input",ExpressionUUID->"08bd949e-09c7-4274-9021-ded33c969bad"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29083, 632, 153, 3, 67, "Section",ExpressionUUID->"1a07ad59-cfec-4557-882c-09253ed4e382"],
Cell[29239, 637, 328, 6, 28, "Input",ExpressionUUID->"6822720e-9313-4d12-86a0-b27e406c6de5"],
Cell[29570, 645, 404, 9, 28, "Input",ExpressionUUID->"376929dc-fe2c-4245-8ac5-0577302e3971"],
Cell[29977, 656, 557, 12, 28, "Input",ExpressionUUID->"ff9ef4dd-5193-4e2f-b17b-410b3aeb46e2"],
Cell[30537, 670, 1537, 38, 48, "Input",ExpressionUUID->"ad13dc27-73bf-449b-a271-f85504dab3f0"],
Cell[32077, 710, 665, 12, 28, "Input",ExpressionUUID->"cea7d7ca-39ae-4814-90b8-7c25bc68d5fe"],
Cell[32745, 724, 183, 3, 28, "Input",ExpressionUUID->"c5320ed3-482d-45e0-ad74-500eeb9afce8"],
Cell[32931, 729, 345, 7, 28, "Input",ExpressionUUID->"3a756df7-96f6-4f99-b4d6-a0acb30542c5"],
Cell[33279, 738, 460, 13, 28, "Input",ExpressionUUID->"480ca9d6-a572-446f-9916-366c1d9eb24c"],
Cell[33742, 753, 974, 24, 48, "Input",ExpressionUUID->"f629ef58-e7d1-4a17-a5f2-5a3dcdc931a7"],
Cell[34719, 779, 353, 5, 28, "Input",ExpressionUUID->"c7b36dfc-6ced-4534-93c6-0953290456e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35109, 789, 225, 4, 67, "Section",ExpressionUUID->"8b8601c3-bd46-4802-a815-03996a17a52e"],
Cell[35337, 795, 443, 8, 28, "Input",ExpressionUUID->"95405783-0746-4898-bcfd-acdcdea65d37"],
Cell[35783, 805, 687, 13, 28, "Input",ExpressionUUID->"0647d9ea-aff7-4a27-95e4-101e0203d761"],
Cell[36473, 820, 1090, 21, 28, "Input",ExpressionUUID->"3acf29e1-9c49-44c8-a959-a2996382e02c"],
Cell[37566, 843, 804, 16, 28, "Input",ExpressionUUID->"86beac50-8f4d-4c45-9722-0ed4ffb80bed"],
Cell[38373, 861, 393, 6, 28, "Input",ExpressionUUID->"40ad6cf0-6f6b-439a-8758-f2ab6eaaecd0"],
Cell[38769, 869, 404, 7, 28, "Input",ExpressionUUID->"ab4e5040-b640-4901-b63b-b5b21d1e7614"],
Cell[39176, 878, 739, 16, 28, "Input",ExpressionUUID->"6f4cdd8f-736f-483b-a7e5-8dbcd4e19ac8"],
Cell[39918, 896, 1315, 22, 28, "Input",ExpressionUUID->"4465b0d4-a7a1-44f8-9cf0-0225fde7d973"],
Cell[41236, 920, 543, 11, 28, "Input",ExpressionUUID->"6db5914e-9748-4647-b506-54af1863e829"]
}, Open  ]]
}
]
*)

